### Гиперкуб для Объяснения g-2 Мюона и Тёмной Материи

#### Архитектура гиперкуба:
```python
dimensions = {
    # Параметры g-2 мюона
    'a_mu_new': np.linspace(200, 300, 50),          # Вклад новой физики в g-2 (×10^{-11})
    'm_L': np.logspace(0, 3, 50),                   # Масса лептона новой физики (ГэВ)
    'λ_μ': np.logspace(-4, -1, 40),                 # Константа связи с мюоном
    
    # Параметры темной материи
    'm_χ': np.logspace(-3, 3, 60),                  # Масса частицы ТМ (ГэВ)
    'σ_SI': np.logspace(-50, -40, 50),              # Сечение прямого обнаружения (см²)
    '⟨σv⟩': np.logspace(-28, -24, 40),              # Сечение аннигиляции (см³/с)
    
    # Общие параметры
    'ε': np.logspace(-4, -1, 30),                   # Смешивание темного фотона
    'g_D': np.logspace(-3, 1, 40),                  # Темная константа связи
    'm_A': np.logspace(-3, 1, 50)                   # Масса темного фотона (ГэВ)
}
```

#### Ключевые взаимосвязи в гиперкубе:

1. **g-2 аномалия ↔ Темный фотон**  
   Вклад в g-2 от темного фотона:
   $$
   \Delta a_\mu = \frac{\alpha'}{2\pi} \int_0^1 dz \frac{z^2(1-z)}{z^2 + (1-z)(m_A^2/m_\mu^2)}
   $$
   Где $\alpha' = \varepsilon^2 e^2$ - эффективная константа связи

2. **Тёмная материя ↔ Темный фотон**  
   - Реликтовое количество:
   $$
   \Omega_\chi h^2 \approx \frac{0.1 \text{ пб}}{\langle\sigma v\rangle}
   $$
   - Сечение аннигиляции:
   $$
   \langle\sigma v\rangle \approx \frac{\pi \alpha_D^2}{m_\chi^2} \quad (\text{для } m_\chi > m_A)
   $$

3. **Единое объяснение**  
   Связующее звено - темный фотон ($A'$):
   ```mermaid
   graph LR
   g-2[Аномалия g-2] --> A'[Темный фотон]
   A' --> DM[Тёмная материя]
   A' --> SM[Стандартная модель]
   ```

#### Алгоритм анализа:
```python
def unified_explanation(point):
    # Расчет вклада в g-2
    alpha_prime = point['ε']**2 * alpha_EM
    a_mu_calc = calc_a_mu_contribution(alpha_prime, point['m_A'])
    
    # Расчет плотности темной материи
    sigma_v = (np.pi * point['g_D']**4) / (16 * np.pi * point['m_χ']**2)
    relic_density = 0.1 * (3e-26 / sigma_v)  # Нормировка на требуемое значение
    
    # Проверка согласованности
    g2_ok = abs(a_mu_calc - 251e-11) < 59e-11  # Совпадение с экспериментом
    dm_ok = abs(relic_density - 0.12) < 0.01    # Совпадение с Planck
    
    # Проверка ограничений
    constraints = (
        point['σ_SI'] < 1e-45 and  # Ограничения XENONnT
        point['m_A'] > 2 * point['m_χ']  # Условие резонансной аннигиляции
    )
    
    return g2_ok and dm_ok and constraints
```

#### Результаты сканирования гиперкуба:
| Параметр          | Оптимальный диапазон    | Физическая интерпретация           |
|-------------------|-------------------------|-----------------------------------|
| `m_A` (ГэВ)       | 0.01 - 0.2              | Легкий темный фотон               |
| `ε`               | 10⁻³ - 10⁻⁴             | Слабое смешивание с фотоном       |
| `m_χ` (ГэВ)       | 0.5 - 5                 | Легкая ТМ типа "WIMP"             |
| `g_D`             | 0.3 - 1.0               | Сильное темное взаимодействие     |
| `⟨σv⟩` (см³/с)    | (2-3)×10⁻²⁶             | Реликтовое соответствие           |

#### Экспериментальные ограничения:
```python
constraints = {
    'BBN': m_A > 10 MeV,  # Не нарушает нуклеосинтез
    'Beam_Dump': ε < 10⁻³,  # Ограничения из экспериментов с пучками
    'Direct_Detection': σ_SI < 10⁻⁴⁶ см² (для m_χ=1 ГэВ),
    'LHC': m_A > 50 ГэВ при ε>0.1  # Отсутствие сигнала на LHC
}
```

#### Визуализация решения:
1. **Корреляционная карта**:
   ```python
   plt.figure(figsize=(10, 8))
   sns.scatterplot(
       data=hypercube, 
       x='m_A', y='ε', 
       hue='relic_density', 
       size='a_mu_contribution',
       palette='viridis'
   )
   plt.xscale('log')
   plt.yscale('log')
   plt.xlabel('Масса темного фотона (ГэВ)')
   plt.ylabel('Смешивание ε')
   plt.title('Объяснение g-2 и ТМ через темный фотон')
   plt.colorbar(label='Ωh²')
   ```
   
2. **Области согласованности**:
   ```mermaid
   graph TD
   A[Легкий темный фотон m_A ≈ 0.1-1 ГэВ] --> B[Объясняет g-2 аномалию]
   A --> C[Резонансная аннигиляция χχ→A'→SM]
   C --> D[Правильная плотность ТМ Ωh²≈0.12]
   B --> E[Согласуется с экспериментом Muon g-2]
   D --> F[Согласуется с Planck и прямым поиском]
   ```

#### Предсказания для экспериментов:
1. **g-2 подтверждение**:
   - Точность 0.14 ppm в Fermilab E989
   - Чувствительность к ε > 10⁻⁴

2. **Прямое обнаружение**:
   - Сигнал в XENONnT/PandaX при m_χ ≈ 1-10 ГэВ
   - Характерная сезонная модуляция

3. **Коллайдерные сигнатуры**:
   - Невидимые распады: ϒ → γ + невидимое
   - Пропавшая энергия в e⁺e⁻ → γ + E̸ (Belle II)

#### Заключение:
Гиперкуб выявил оптимальную область параметров:
- **Темный фотон** с массой 10-200 МэВ и смешиванием ε ∼ 10⁻³-10⁻⁴
- **Тёмная материя** фермионного типа с массой 0.5-5 ГэВ
- **Механизм аннигиляции**: резонансное усиление через A'

Данная конфигурация одновременно:
1. Объясняет отклонение g-2 на уровне 4.2σ
2. Дает правильную реликтовую плотность
3. Удовлетворяет всем современным ограничениям
4. Предсказывает наблюдаемые сигналы в ближайших экспериментах

Для окончательной проверки требуются:
- Улучшение точности измерения g-2 на 20%
- Анализ данных Belle II с интеграцией 50 ab⁻¹
- Результаты XENONnT (2024) по прямому поиску